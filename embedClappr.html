<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Compartiendo esperanza!">
  <meta name="keywords"
    content="Pel√≠culas Online,Pel√≠culas gratis,Ver Pel√≠culas Online, pel√≠culas adventistas, IASD, Adventista.org,Alejandro Bull√≥n, PROYECTO JA, m√∫sica cristiana, m√∫sica adventista, radio adventistas, televisi√≥n adventista, tv adventista, 3abn,3abn latino, esperanza tv,esperanza tv costa rica, nuevo tiempo per√∫, tv nuevo tiempo per√∫, radio nuevo tiempo per√∫, pel√≠culas cristianas, pel√≠culas cristianas en hd gratis, pel√≠culas adventistas gratis, feliz7play">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> <!-- Para Internet Explorer -->

  <!--Vista previa del enlace-->
  <meta property="og:title" content="PROYECTO JA" />
  <meta property="og:description" content="Compartiendo esperanza!" />
  <meta property="og:url" content="https://proyectoja.github.io/proyectoja/" />
  <meta property="og:image" content="https://i.imgur.com/ayIV94z.jpg" />
  <meta property="og:type" content="website" />

  <title>PROYECTO JA</title>
  <script src="clappr.js"></script>
  <script src="clappr-pip-plugin.js"></script>
  <script src="level-selector.js"></script>
  <script src="clappr-playback-rate.js"></script>
  <script src="clappr-video360.js"></script>
  <script src="dashShakaPlayBack.js"></script>
  <script src="hlsjs-playback.js"></script>
  <script src="clappr-youtube-playback.js"></script>
  <script src="audio-track-selector.js"></script>

  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clappr-stats/dist/clappr-stats.min.js"></script>
  <script type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/clappr-nerd-stats/dist/clappr-nerd-stats.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clappr-thumbnails-plugin@3"></script>
  <link rel="icon" href="https://i.imgur.com/VpYkRpa.png" type="image/png">

  <style>
    body {
      margin: 0%;
      padding: 0%;
      box-sizing: border-box;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background-color: #000;
      background-image: url('https://i.imgur.com/PH40Vz0.png');
      background-position: center;
      background-repeat: no-repeat;
      background-size: contain;
      -moz-user-select: none;
      -webkit-user-drag: none;
    }

    .container-cont-principal {
      display: none;
    }

    .container-cont-principal #live-button {
      padding: 7px;
      padding-top: 3px;
      padding-bottom: 3px;
      background-color: gray;
      color: white;
      border: none;
      border-top-left-radius: 50px;
      border-bottom-left-radius: 50px;
      font-size: 14px;
      font-family: Verdana, Geneva, Tahoma, sans-serif;
      display: block;
      position: relative;
      text-wrap: nowrap;
      margin-left: 10px;
    }

    .container-cont-principal #live-button.live {
      background-color: red;
      animation: parpadeo 3s infinite;
    }

    @keyframes parpadeo {
      0% {
        background-color: red;
      }

      15% {
        background-color: rgba(0, 0, 0, 0.7);
      }

      30% {
        background-color: red;
      }

      100% {
        background-color: red;
      }
    }

    .container-cont-principal #viewer-count {
      margin-left: 5px;
      padding: 7px;
      padding-right: 12px;
      padding-top: 3px;
      padding-bottom: 3px;
      background-color: rgba(0, 0, 0, 0.7);
      color: white;
      border: none;
      border-top-right-radius: 50px;
      border-bottom-right-radius: 50px;
      font-size: 14px;
      font-family: Verdana, Geneva, Tahoma, sans-serif;
      display: block;
      position: relative;
      text-wrap: nowrap;
    }

    .container-cont-principal img {
      background-color: transparent;
      width: 27px;
      height: 27px;
      border: 2px solid rgba(255, 0, 0);
      border-radius: 50%;
      margin: 0;
      margin-left: 10px;
      margin-right: 5px;
      margin-top: 0px;
      padding: 0px;
      display: block;
      position: relative;
      justify-content: center;
      align-items: center;
    }

    .container-cont-principal h2 {
      display: block;
      position: relative;
      text-wrap: nowrap;
      margin: 0;
      color: #fff;
      font-size: 18px;
      font-family: Verdana, Geneva, Tahoma, sans-serif;
      text-shadow: 0px 0px 10px #000;
    }
  </style>
</head>

<body>
  <!-- Contenedor del reproductor -->
  <div id="player"></div>
  <div class="container-cont-principal" id="container-cont-principal">
    <img src="logo3.png"></img>
    <h2>PROYECTO JA</h2>
    <button id="live-button">‚ö´ No hay emisi√≥n</button>
    <div id="viewer-count">üëÅÔ∏è 0</div>
  </div>

  <script>
    //Eventos para obtener el contador de usuarios de chatBro
    var onlineDiv = document.getElementById('viewer-count');
    document.addEventListener('chatLoaded', function () {
      document.addEventListener('chatbroPtCountChanging', function (event) {
        onlineDiv.innerHTML = `üëÅÔ∏è ${JSON.stringify(event.ptCount.web)}`;
      });
    });
    // Funci√≥n para obtener par√°metros de la URL
    function getUrlParameter(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }
    let player = null;
    let activeEnVivo = 0;
    let liveButton = document.getElementById('live-button');
    let viewerCount = document.getElementById('viewer-count');
    let livePerfil = document.querySelector('.container-cont-principal img');

    const username = "XSTUDIOCODE";
    // Obtenemos el par√°metro 'video' desde la URL
    let url = getUrlParameter('url');
    let posterUrl = getUrlParameter('poster');
    let nombreCanal = getUrlParameter('nombreCanal');
    let perfilCanal = getUrlParameter('perfilCanal');
    const idCanal = getUrlParameter('id');


    //Hacemos la validaci√≥n para el id del json
    async function cargarDatosPrimero() {
      if (idCanal) {
        try {
          const response = await fetch("contenido.json");
          const data = await response.json();
          const datoEncontrado = Object.values(data).flat().find((idAux) => idAux.id === idCanal);
          if (datoEncontrado) {
            url = datoEncontrado.url;
            posterUrl = datoEncontrado.poster;
            nombreCanal = datoEncontrado.nombreCanal;
            perfilCanal = datoEncontrado.perfilCanal;
          }
        } catch (error) {
          console.error("Error al cargar el archivo JSON:", error);
        };
      }
    }

    //Importante, comienzo de todo el reproductor
    setTimeout(() => {
      cargarDatosPrimero().then(() => {
        funcionInicial();
      })
    }, 1000);

    // Funci√≥n para inicializar el reproductor con video MP4
    function initializeMp4Player(url, posterUrl) {
      if (player) {
        player.destroy(); // Destruye el reproductor si ya est√° activo
      }

      player = new Clappr.Player({
        source: url,
        parentId: "#player",
        poster: posterUrl,
        width: "100%",
        height: "100vh",
        autoPlay: false, //Desarrollo
        hideVolumeBar: false,
        hideMediaControl: true, //Desarrollo
        playbackNotSupportedMessage: 'No se puede reproducir.',
        plugins: [AudioTrackSelector,HlsjsPlayback, DashShakaPlayback, ClapprPip.PipButton, ClapprPip.PipPlugin, LevelSelector, PlaybackRatePlugin],
        playbackRateConfig: {
          defaultValue: 1,
          options: [
            { value: 0.1, label: '0.1x' },
            { value: 0.5, label: '0.5x' },
            { value: 0.75, label: '0.75x' },
            { value: 1, label: 'Normal' },
            { value: 1.5, label: '1.5x' },
            { value: 2, label: '2x' },
            { value: 4, label: '4x' },
          ],
          // rateSuffix: 'x',
        },
        //watermark: "https://i.imgur.com/ymjjVCQ.png", position: 'top-right'
      });

      // Verificar si la barra de control est√° disponible
      player.on(Clappr.Events.PLAYER_READY, function () {
        addCustomElementsMp4();
      });
      player.on(Clappr.Events.PLAYER_PLAY, function () {
        addCustomElementsMp4();
      });
      player.on(Clappr.Events.PLAYER_STOP, function () {
        addCustomElementsMp4();
      });
      

      function addCustomElementsMp4() {
        const customContainer = document.getElementById('container-cont-principal');
        customContainer.style.display = 'flex';
        customContainer.style.position = 'absolute';
        customContainer.style.zIndex = '-1';
        customContainer.style.flexDirection = 'row';
        customContainer.style.width = 'auto';
        customContainer.style.height = '100%';
        customContainer.style.right = '10px';
        customContainer.style.bottom = '55px';
        customContainer.style.justifyContent = 'center';
        customContainer.style.alignItems = 'center';

        const customContainerImg = document.querySelector('#container-cont-principal img');
        if (perfilCanal) {
          customContainerImg.src = perfilCanal;
        }

        const customContainerH2 = document.querySelector('#container-cont-principal h2');
        if (nombreCanal) {
          customContainerH2.textContent = nombreCanal;
        }

        const controlBarRight = document.querySelector('.media-control .media-control-layer .media-control-right-panel');
        if (!controlBarRight.querySelector('#logo')) {
          const img = document.createElement('img');
          img.style.display = 'flex';
          img.style.position = 'relative';
          img.style.top = '0px';
          img.src = 'logo1.png';
          img.alt = 'Logo';
          img.style.width = 'auto';
          img.style.height = '100%';
          img.style.margin = '0px';
          img.style.padding = '0px';
          img.id = 'logo';
          img.style.cursor = 'pointer';
          img.onclick = () => {
            window.open('https://www.whatsapp.com/channel/0029VaDMfYK5fM5bmqhsxk0h', '_blank');
          };
          controlBarRight.appendChild(img);
        }
        controlBarRight.appendChild(customContainer);
        liveButton.style.display = 'none';
        viewerCount.style.display = 'none';
        livePerfil.style.border = '2px solid #0066ff';
      }
    }

    // Funci√≥n para inicializar el reproductor para transmisi√≥n en vivo (HLS)
    function initializeLivePlayer(streamUrl, posterUrl) {
      if (player) {
        player.destroy(); // Destruye el reproductor si ya est√° activo
      }
      player = new Clappr.Player({
        source: streamUrl,
        parentId: "#player",
        poster: posterUrl,
        width: "100%",
        height: "100vh",
        autoPlay: false, //Desarrollo
        hideVolumeBar: false,
        actualLiveTime: true,
        actualLiveServerTime: "2024/09/30 00:00:00",
        hideMediaControl: true, //Desarrollo
        playbackNotSupportedMessage: 'No se puede reproducir.',
        plugins: [AudioTrackSelector,HlsjsPlayback, DashShakaPlayback, ClapprPip.PipButton, ClapprPip.PipPlugin, LevelSelector, PlaybackRatePlugin],
        hlsUseNextLevel: true, // Permite cambiar de calidad autom√°ticamente
        hlsMinimumDvrSize: 120, // Buffer m√≠nimo de 2 minutos para DVR
        hlsRecoverAttempts: 16, // Reduce los intentos de recuperaci√≥n para evitar loops infinitos
        hlsPlayback: {
          preload: true, // Precarga el video antes de presionar "play"
          customListeners: [], // Espacio para eventos personalizados
        },
        playback: {
          crossOrigin: "anonymous",
          extrapolatedWindowNumSegments: 2,
          triggerFatalErrorOnResourceDenied: false,
          hlsjsConfig: {
            enableWebVTT: true,
            captions: true, // Activa subt√≠tulos en HLS
            maxBufferLength: 30, // Mantiene un buffer de 30 segundos
            maxBufferSize: 60 * 1000 * 1000, // M√°ximo de 60 MB de buffer
            liveSyncDuration: 5, // Sincronizaci√≥n de 5 segundos con la transmisi√≥n en vivo
            liveMaxLatencyDuration: 60, // Retraso m√°ximo de 10 segundos en vivo
            enableWorker: true, // Usa workers para mejorar el rendimiento
            enableSoftwareAES: true, // Mejora la compatibilidad con flujos cifrados
            capLevelToPlayerSize: true, // Ajusta la calidad seg√∫n el tama√±o del reproductor
            autoStartLoad: true, // Carga autom√°ticamente los fragmentos
            startPosition: -1, // Inicia desde el punto m√°s reciente en transmisi√≥n en vivo
            maxRetries: 9999, // Intentos m√°ximos antes de detener la reproducci√≥n
            retryDelay: 2000, // Retraso de 2 segundos entre intentos de recuperaci√≥n
            lowLatencyMode: true, // Habilita el modo de baja latencia
          },
        },
        playbackRateConfig: {
          defaultValue: 1,
          options: [
            { value: 0.1, label: '0.1x' },
            { value: 0.5, label: '0.5x' },
            { value: 0.75, label: '0.75x' },
            { value: 1, label: 'Normal' },
            { value: 1.5, label: '1.5x' },
            { value: 2, label: '2x' },
            { value: 4, label: '4x' },
          ],
          // rateSuffix: 'x',
        },
        levelSelectorConfig: {
          title: 'Calidad',
          labels: {
            7: '',
            6: '',
            5: '',
            4: '',
            3: '',
            2: '', // 500kbps
            1: '', // 240kbps
            0: '', // 120kbps
          },
          labelCallback: function (playbackLevel, customLabel) {
            return customLabel + playbackLevel.level.height + 'p'; // High 720p
          },
          onLevelsAvailable: function (levels) {
            return levels.reverse(); // For example, reverse levels order
          },
        },

        //watermark: "https://i.imgur.com/ymjjVCQ.png", position: 'top-right'
      });

      player.getPlugin('click_to_pause').disable();
      // Verificar si la barra de control est√° disponible
      player.on(Clappr.Events.PLAYER_READY, function () {
        addCustomElements();
      });
      player.on(Clappr.Events.PLAYER_PLAY, function () {
        addCustomElements();
      });
      player.on(Clappr.Events.PLAYER_STOP, function () {
        addCustomElements();
      });
      player.on(Clappr.Events.PLAYER_ERROR, function () {
        if (idCanal === 't1') {
          auxUrlDoce = 'PLPVicAS85pXJtwNCGdnpNr5PBm_5VCPup';
          youtubeClappr(auxUrlOnce, auxUrlDoce);
        }
      });

      function addCustomElements() {
        const customContainer = document.getElementById('container-cont-principal');
        customContainer.style.display = 'flex';
        customContainer.style.position = 'absolute';
        customContainer.style.zIndex = '-1';
        customContainer.style.flexDirection = 'row';
        customContainer.style.width = 'auto';
        customContainer.style.height = '100%';
        customContainer.style.right = '10px';
        customContainer.style.bottom = '55px';
        customContainer.style.justifyContent = 'center';
        customContainer.style.alignItems = 'center';

        const customContainerImg = document.querySelector('#container-cont-principal img');
        if (perfilCanal) {
          customContainerImg.src = perfilCanal;
        }

        const customContainerH2 = document.querySelector('#container-cont-principal h2');
        if (nombreCanal) {
          customContainerH2.textContent = nombreCanal;
        }

        const controlBarRight = document.querySelector('.media-control .media-control-layer .media-control-right-panel');
        if (!controlBarRight.querySelector('#logo')) {
          const img = document.createElement('img');
          img.style.display = 'flex';
          img.style.position = 'relative';
          img.style.top = '0px';
          img.src = 'logo1.png';
          img.alt = 'Logo';
          img.style.width = 'auto';
          img.style.height = '100%';
          img.style.margin = '0px';
          img.style.padding = '0px';
          img.id = 'logo';
          img.style.cursor = 'pointer';
          img.onclick = () => {
            window.open('https://www.whatsapp.com/channel/0029VaDMfYK5fM5bmqhsxk0h', '_blank');
          };
          controlBarRight.appendChild(img);
        }


        controlBarRight.appendChild(customContainer);
      }



      // Detecta cambios en el estado de la reproducci√≥n
      player.on(Clappr.Events.PLAYER_PLAY, function () {
        liveButton.classList.add('live');
        liveButton.innerText = 'üî¥ EN VIVO';
        activeEnVivo = 1;
        livePerfil.style.border = '2px solid rgba(255,0,0)';

        //fetchViewerCount(); // Obtener el contador de espectadores al iniciar la transmisi√≥n
        activeEnVivoFunction();
      });

      player.on(Clappr.Events.PLAYER_STOP, function () {
        liveButton.classList.remove('live');
        liveButton.innerText = '‚ö´ Emisi√≥n detenida';
        activeEnVivo = 2;
        livePerfil.style.border = '2px solid transparent';

        viewerCount.innerText = `üëÅÔ∏è`; // Resetea el contador
        activeEnVivoFunction();
      });

      player.on(Clappr.Events.PLAYER_PAUSE, function () {
        // Cuando se pausa la transmisi√≥n
        liveButton.classList.remove('live');
        liveButton.innerText = 'üü° Emisi√≥n en pausa';
        activeEnVivo = 3;
        livePerfil.style.border = '2px solid transparent';
        viewerCount.innerText = `üëÅÔ∏è`;
        addCustomElements();
        activeEnVivoFunction();
      });

      // Verificaci√≥n inicial al cargar la p√°gina
      if (player && player.isPlaying()) {
        liveButton.classList.add('live');
        liveButton.innerText = 'üî¥ EN VIVO';
        activeEnVivo = 1;
        livePerfil.style.border = '2px solid rgba(255,0,0)';

        activeEnVivoFunction();
      } else {
        liveButton.classList.remove('live');
        liveButton.innerText = '‚ö´ No hay emisi√≥n';
        activeEnVivo = 0;
        livePerfil.style.border = '2px solid transparent';

        activeEnVivoFunction();
      }
    }

    // Funci√≥n para cargar el script de Chatbro
    function executeChatbroScript() {
      const script = document.createElement('script');
      script.id = 'chatBroEmbedCode';
      script.textContent = `
    /* Chatbro Widget Embed Code Start */
    function ChatbroLoader(chats, async) { 
      async = !1 !== async; 
      var params = { 
        embedChatsParameters: chats instanceof Array ? chats : [chats], 
        lang: navigator.language || navigator.userLanguage, 
        needLoadCode: 'undefined' == typeof Chatbro, 
        embedParamsVersion: localStorage.embedParamsVersion, 
        chatbroScriptVersion: localStorage.chatbroScriptVersion 
      }, 
      xhr = new XMLHttpRequest; 
      xhr.withCredentials = !0, 
      xhr.onload = function () { eval(xhr.responseText) }, 
      xhr.onerror = function () { console.error('Chatbro loading error') }, 
      xhr.open('GET', 'https://www.chatbro.com/embed.js?' + btoa(unescape(encodeURIComponent(JSON.stringify(params)))), async), 
      xhr.send() 
    }
    ChatbroLoader({ encodedChatId: '2916T' });
    /* Chatbro Widget Embed Code End */
  `;
      document.body.appendChild(script);
    }

    function activeEnVivoFunction() {
      switch (activeEnVivo) {
        case 1:
          // PLAY
          if (!window.titleInterval) {
            window.titleInterval = setInterval(() => {
              document.title = document.title === "EN VIVO üî¥" ? "EN VIVO ‚ö´" : "EN VIVO üî¥";
            }, 1000);
          }
          break;
        case 2:
          // STOP
          clearInterval(window.titleInterval);
          document.title = "EN VIVO ‚ö´";
          delete window.titleInterval;
          break;
        case 3:
          // PAUSE
          if (!window.titleInterval) {
            window.titleInterval = setInterval(() => {
              document.title = document.title === "EN VIVO üü°" ? "EN VIVO ‚ö´" : "EN VIVO üü°";
            }, 1000);
          }
          break;
        default:
          document.title = "EN VIVO";
          clearInterval(window.titleInterval);
          delete window.titleInterval;
      }
    }


    let auxUrlDoce, auxUrlOnce;
    function funcionInicial() {
      // Comprobamos si el par√°metro 'video' existe
      if (url) {
        // Si es un archivo MP4
        if (url.endsWith('.mp4') || url.includes('.mp4')) {
          initializeMp4Player(url, posterUrl);
        }
        // Si es una transmisi√≥n en vivo en formato HLS (.m3u8)
        else if (url.includes('.m3u8') && url.includes('XSTUDIOCODE')) {
          initializeLivePlayer(url, posterUrl);
          executeChatbroScript();
        } else if (url.includes('.m3u8')) {
          initializeLivePlayer(url, posterUrl);
          onlineDiv.innerHTML = "üëÅÔ∏è";
          onlineDiv.style.backgroundColor = '#003399';
        } else if (url.includes('.mpd')) {
          initializeLivePlayer(url, posterUrl);
          onlineDiv.innerHTML = "üëÅÔ∏è";
          onlineDiv.style.backgroundColor = '#003399';
        } else {
          //Embed para youtube y listas de youtube
          if (url.length >= 12) {
            auxUrlDoce = url;
          } else {
            auxUrlOnce = url;
          }
          youtubeClappr(auxUrlOnce, auxUrlDoce);
        }
      } else if (false) {
        //
      } else {
        const fondoPlayer = document.getElementById('player');
        fondoPlayer.style.backgroundImage = `url("error-404.jpg")`;
        fondoPlayer.style.backgroundPosition = 'center';
        fondoPlayer.style.backgroundRepeat = 'no-repeat';
        fondoPlayer.style.backgroundSize = 'cover';
        fondoPlayer.style.width = '100%';
        fondoPlayer.style.height = '100vh';
      }

      document.body.style.backgroundImage = `url("${posterUrl}")`;
      //Eventos muy importante
      var playerElement = document.getElementById("player");

      // Evitar clic derecho en el √°rea del reproductor
      playerElement.addEventListener("contextmenu", function (event) {
        event.preventDefault(); // Prevenir el men√∫ contextual
      });
    }

    function youtubeClappr(auxUrlOnce, auxUrlDoce) {
      if (player) {
        player.destroy(); // Destruye el reproductor si ya est√° activo
      }
      player = new Clappr.Player({
        source: auxUrlOnce,
        height: "100vh",
        width: "100%",
        youtubeShowRelated: true,
        youtubePlaylist: auxUrlDoce,
        plugins: [YoutubePlayback],
        parentId: "#player"
      });
    }
  </script>
</body>

</html>