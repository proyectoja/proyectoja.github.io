<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ’Œ Carta para Ti ðŸ’–</title>
<style>
  * { box-sizing: border-box; }
  body {
    margin: 0;
    height: 100vh;
    background: linear-gradient(135deg, #fcb7af, #f7a7c5, #fbd3e9);
    background-size: 300% 300%;
    animation: gradientMove 12s ease infinite;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Poppins', sans-serif;
    overflow: hidden;
  }
  @keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  .envelope {
    position: relative;
    width: 320px;
    height: 220px;
    background: #ffcad4;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.2);
    cursor: pointer;
    transition: transform 0.6s;
    transform-style: preserve-3d;
  }
  .envelope.open { transform: rotateX(180deg); }
  .flap {
    position: absolute;
    width: 100%;
    height: 100%;
    background: #ffb6c1;
    clip-path: polygon(0 0, 100% 0, 50% 70%);
    transform-origin: top;
    transition: transform 1s;
    border-radius: 10px 10px 0 0;
  }
  .envelope.open .flap { transform: rotateX(180deg); }
  .letter {
    position: absolute;
    top: 20px;
    left: 10px;
    right: 10px;
    bottom: 10px;
    background: #fff;
    border-radius: 5px;
    padding: 20px;
    transform: rotateX(180deg);
    backface-visibility: hidden;
    overflow-y: auto;
  }
  .text { font-size: 1.1em; color: #444; white-space: pre-wrap; font-style: italic; }
  #signature { margin-top: 20px; font-style: italic; color: #e75480; text-align: right; opacity: 0; transition: opacity 2s; }
  .heart { position: fixed; font-size: 20px; color: #fff; opacity: 0.8; animation: float 8s linear infinite; z-index: 100; }
  @keyframes float { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-100vh) scale(1.5); opacity: 0; } }
  #hint { position: absolute; bottom: 50px; color: #fff; font-size: 1.1em; text-shadow: 0 0 5px rgba(0,0,0,0.3); animation: fadeHint 2s infinite alternate; }
  @keyframes fadeHint { from { opacity: 0.6; } to { opacity: 1; } }
</style>
</head>
<body>

<div class="envelope" id="envelope">
  <div class="flap"></div>
  <div class="letter" id="letter">
    <div class="text" id="text"></div>
    <div id="signature">Con todo mi amor, siempre tuyo, ðŸ’•<br>â€” Kendall Torres</div>
  </div>
</div>

<div id="hint">ðŸ’Œ Toca la carta para abrirla ðŸ’ž</div>

<audio id="music" loop>
  <source src="https://proyectoja.github.io/audioCarta1.mp3" type="audio/mp3">
</audio>

<script>
const texto = `
29/10/2025

Mi amor Luna, Rebeca Luna...

A veces las palabras se quedan cortas,
pero aun asÃ­ quiero intentar decirte lo que siento.

Desde que llegaste a mi vida,
todo tiene sentido, color y esperanza. ðŸŒ·

Tu voz calma mi alma,
tu sonrisa ilumina mis dÃ­as
y tu amor me enseÃ±a lo que significa vivir de verdad. âœ¨

No hay distancia ni tiempo que apague lo que siento.
Eres mi razÃ³n, mi refugio y mi sueÃ±o mÃ¡s bonito. â¤ï¸

TE AMO MI BOMBONCITO ðŸ¥°ðŸ˜˜

Quiero que sepas que cada momento contigo
se convierte en un recuerdo eterno que guardo en mi corazÃ³n.

Me encanta cÃ³mo tus ojos brillan cuando sonrÃ­es,
cÃ³mo tu risa contagia alegrÃ­a y hace que todo a mi alrededor sea mÃ¡s bonito. ðŸŒ¸

Si pudiera, detendrÃ­a el tiempo cada vez que estamos juntos,
porque cada segundo a tu lado es un tesoro invaluable.

Gracias por cada gesto, cada palabra y cada abrazo,
porque me recuerdan lo afortunado que soy de tenerte en mi vida. ðŸ’ž

SueÃ±o con nuestro futuro, con todos los planes y aventuras
que aÃºn nos esperan, y me emociona saber que
los recorreremos juntos, siempre apoyÃ¡ndonos y creciendo. ðŸŒˆ

Quiero ser tu paz en los dÃ­as difÃ­ciles,
tu compaÃ±Ã­a en los momentos alegres,
y tu amor incondicional en cada paso que demos. âœ¨

Eres mi todo, mi inspiraciÃ³n y mi hogar.
Mi corazÃ³n late por ti y solo por ti, ahora y siempre. ðŸ’–

Cada dÃ­a a tu lado me enseÃ±a lo que significa amar de verdad,
y no hay momento que no desee que dure para siempre. ðŸŒ¹

Me enamoro mÃ¡s de ti con cada risa, cada mirada y cada abrazo.
Eres la melodÃ­a que da sentido a mis dÃ­as y la calma en mis noches. ðŸŽ¶ðŸ’–


A veces cierro los ojos y siento tu mano entre la mÃ­a,
y en esos segundos el mundo desaparece,
solo existimos tÃº y yo, conectados por algo que va mÃ¡s allÃ¡ de las palabras. ðŸ’ž

Gracias por enseÃ±arme que el amor no solo se siente,
sino que se vive en cada gesto, en cada detalle,
y por elegirme todos los dÃ­as, como yo te elijo a ti. ðŸŒˆ

Prometo seguir construyendo sueÃ±os contigo,
apoyarte en cada meta, celebrar tus victorias
y ser tu refugio en los dÃ­as grises. ðŸŒ¸

Gracias por ser tÃº, por existir y por amarme de la manera mÃ¡s hermosa. ðŸŒ¹

Prometo cuidarte, escucharte y amarte cada dÃ­a de mi vida,
porque tÃº eres el regalo mÃ¡s precioso que jamÃ¡s podrÃ­a pedir. ðŸ’

Te amo con todo mi ser, Luna, y siempre lo harÃ©. ðŸ˜˜ðŸ¥°`;

const envelope = document.getElementById("envelope");
const textBox = document.getElementById("text");
const signature = document.getElementById("signature");
const music = document.getElementById("music");
let abierto = false;

// Dividimos el texto en pÃ¡rrafos
const parrafos = texto.split('\n\n');
let parrafoIndex = 0;
let charIndex = 0;
let pausaActiva = false;
let escrituraEnCurso = false; // Control para evitar velocidad rÃ¡pida

// Definimos las pausas por tiempo de audio en segundos
const pausas = [
  {start: 0, end: 14, parrafo: 2},  // pausa despuÃ©s del primer pÃ¡rrafo
  {start: 70, end: 83, parrafo: 10} // pausa despuÃ©s del pÃ¡rrafo 10
];

function escribirTexto() {
  if (parrafoIndex >= parrafos.length) {
    signature.style.opacity = 1;
    return;
  }

  // Pausa segÃºn audio
  const currentTime = music.currentTime;
  for (let p of pausas) {
    if (currentTime >= p.start && currentTime < p.end && parrafoIndex >= p.parrafo) {
      pausaActiva = true;
      escrituraEnCurso = false;
      return;
    }
  }

  escrituraEnCurso = true; // Bucle activo

  const parrafo = parrafos[parrafoIndex];
  if (charIndex < parrafo.length) {
    textBox.textContent += parrafo.charAt(charIndex);
    charIndex++;
    setTimeout(escribirTexto, 70);
  } else {
    textBox.textContent += '\n\n';
    charIndex = 0;
    parrafoIndex++;
    setTimeout(escribirTexto, 70);
  }
}

// Reanuda automÃ¡ticamente cuando se pasa la pausa
music.addEventListener("timeupdate", () => {
  if (pausaActiva) {
    const currentTime = music.currentTime;
    for (let p of pausas) {
      if (currentTime >= p.end) {
        pausaActiva = false;
        if (!escrituraEnCurso) escribirTexto(); // Evita duplicar velocidad
      }
    }
  }
});

// FunciÃ³n de corazones flotantes
function crearCorazones() {
  const heart = document.createElement("div");
  heart.classList.add("heart");
  heart.textContent = "â¤ï¸";
  heart.style.left = Math.random() * 100 + "vw";
  heart.style.fontSize = Math.random() * 40 + "px";
  heart.style.animationDuration = (10 + Math.random() * 4) + "s";
  document.body.appendChild(heart);
  setTimeout(() => heart.remove(), 10000);
}

setInterval(crearCorazones, 400);

// Abrir sobre y comenzar mÃºsica/escritura
envelope.addEventListener("click", () => {
  if (!abierto) {
    envelope.classList.add("open");
    document.getElementById("hint").style.display = "none";
    music.play().catch(() => {
      document.body.addEventListener("click", () => music.play(), { once: true });
    });
    setTimeout(escribirTexto, 500);
    abierto = true;
  }
});
</script>

</body>
</html>
